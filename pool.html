<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>LATAKIANO Pro Pool - Play & Win</title>
    <style>
        body { background: #0a0a0a; color: white; text-align: center; font-family: 'Arial', sans-serif; margin: 0; overflow: hidden; }
        .header { background: #222; padding: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.5); }
        #scoreBoard { font-size: 1.5rem; color: #4caf50; font-weight: bold; margin: 10px; }
        canvas { background: #0e5c1f; border: 15px solid #5d3a1a; border-radius: 15px; box-shadow: 0 0 50px rgba(0,0,0,0.8); cursor: crosshair; touch-action: none; }
    </style>
</head>
<body>
    <div class="header">
        <h1>LATAKIANO POOL ARENA</h1>
        <div id="scoreBoard">Balls Sunk: 0</div>
    </div>
    
    <canvas id="poolCanvas" width="800" height="400"></canvas>
    
    <div style="margin-top: 20px;">
        <a href="index.html" style="color: #888; text-decoration: none; border: 1px solid #444; padding: 5px 15px; border-radius: 5px;">Back to Lobby</a>
    </div>

    <script>
        const canvas = document.getElementById('poolCanvas');
        const ctx = canvas.getContext('2d');
        const scoreElement = document.getElementById('scoreBoard');
        
        let score = 0;
        let balls = [];
        
        // أصوات اللعبة باستخدام نغمات إلكترونية بسيطة (Browser Beeps)
        function playSound(freq, duration) {
            const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            oscillator.frequency.value = freq;
            oscillator.type = 'sine';
            gainNode.gain.setValueAtTime(0.1, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + duration);
            oscillator.start();
            oscillator.stop(audioCtx.currentTime + duration);
        }

        function initGame() {
            balls = [];
            score = 0;
            scoreElement.innerText = `Balls Sunk: ${score}`;
            balls.push({ x: 200, y: 200, r: 12, vx: 0, vy: 0, color: 'white', type: 'cue' });
            let startX = 550, startY = 200, spacing = 26;
            for (let i = 0; i < 5; i++) {
                for (let j = 0; j <= i; j++) {
                    balls.push({
                        x: startX + i * spacing,
                        y: startY - (i * spacing / 2) + j * spacing,
                        r: 12, vx: 0, vy: 0,
                        color: `hsl(${(i * 30) + (j * 15)}, 80%, 50%)`,
                        type: 'target'
                    });
                }
            }
        }

        let isDragging = false;
        let mousePos = { x: 0, y: 0 };

        canvas.onmousedown = (e) => {
            const rect = canvas.getBoundingClientRect();
            mousePos = { x: e.clientX - rect.left, y: e.clientY - rect.top };
            if (Math.hypot(mousePos.x - balls[0].x, mousePos.y - balls[0].y) < 30) isDragging = true;
        };
        canvas.onmousemove = (e) => {
            const rect = canvas.getBoundingClientRect();
            mousePos = { x: e.clientX - rect.left, y: e.clientY - rect.top };
        };
        window.onmouseup = () => {
            if (isDragging) {
                balls[0].vx = (balls[0].x - mousePos.x) * 0.15;
                balls[0].vy = (balls[0].y - mousePos.y) * 0.15;
                playSound(150, 0.2); // صوت الضربة
            }
            isDragging = false;
        };

        function update() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = '#000'; // الثقوب
            [[0,0], [400,0], [800,0], [0,400], [400,400], [800,400]].forEach(p => {
                ctx.beginPath(); ctx.arc(p[0], p[1], 28, 0, Math.PI*2); ctx.fill();
            });

            if (isDragging) {
                ctx.beginPath(); ctx.moveTo(balls[0].x, balls[0].y); ctx.lineTo(mousePos.x, mousePos.y);
                ctx.strokeStyle = 'white'; ctx.setLineDash([5, 5]); ctx.stroke(); ctx.setLineDash([]);
            }

            for (let i = 0; i < balls.length; i++) {
                let b = balls[i];
                b.x += b.vx; b.y += b.vy;
                b.vx *= 0.985; b.vy *= 0.985;

                if (b.x < b.r || b.x > canvas.width - b.r) { b.vx *= -0.8; b.x = b.x < b.r ? b.r : canvas.width - b.r; }
                if (b.y < b.r || b.y > canvas.height - b.r) { b.vy *= -0.8; b.y = b.y < b.r ? b.r : canvas.height - b.r; }

                [[0,0], [400,0], [800,0], [0,400], [400,400], [800,400]].forEach(p => {
                    if (Math.hypot(b.x - p[0], b.y - p[1]) < 28) {
                        if (b.type === 'cue') { b.x = 200; b.y = 200; b.vx = 0; b.vy = 0; }
                        else { 
                            balls.splice(i, 1); score++; 
                            scoreElement.innerText = `Balls Sunk: ${score}`;
                            playSound(600, 0.3); // صوت الفوز بنقطة
                        }
                    }
                });

                for (let j = i + 1; j < balls.length; j++) {
                    let b2 = balls[j];
                    let dx = b2.x - b.x, dy = b2.y - b.y, dist = Math.hypot(dx, dy);
                    if (dist < b.r + b2.r) {
                        let tempVx = b.vx; b.vx = b2.vx; b2.vx = tempVx;
                        let tempVy = b.vy; b.vy = b2.vy; b2.vy = tempVy;
                        if (Math.abs(b.vx) + Math.abs(b.vy) > 0.5) playSound(300, 0.1); // صوت التصادم
                    }
                }
                ctx.fillStyle = b.color; ctx.beginPath(); ctx.arc(b.x, b.y, b.r, 0, Math.PI*2); ctx.fill();
                ctx.strokeStyle = '#000'; ctx.stroke();
            }
            requestAnimationFrame(update);
        }
        initGame(); update();
    </script>
</body>
</html>